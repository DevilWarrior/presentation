<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Presentation | NUKE</title>

		<link rel="stylesheet" href="css/main.css">
		<link rel="stylesheet" href="css/icomoon.css">
		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/black.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">

			<div id="bottom-left">Matthias Koch</div>

			<div class="slides">

				<section>
          <section><h2>Servus!</h2></section>
          <section><h2>Hello!</h2></section>
					<section><h2>Привет<span style="font-size:110%">!</span></h2></section>
        </section>

        <section>
					<section>
						<h2>About me</h2>

						<aside class="notes">
							<ul>
								<li>JetBrains / ReSharper</li>
								<li>Interested in Clean Code, Testing, Tooling</li>
								<li>Devoted to open-source</li>
							</ul>
						</aside>
					</section>
				</section>

				<section>

          <section><img class="no-border" style="width:400px" data-src="images/coffee.jpg" alt="Turn Coffee Into Code"></section>
          <section><img class="no-border" data-src="images/profit.jpg" alt="Way to Success"></section>

          <section>
            <img class="no-border" data-src="images/gradle.png" alt="Build Automation" />
            <span style="font-size:80%">&copy;&nbsp;<a href="https://gradle.org/">https://gradle.org</a></span>

            <aside class="notes">
              <ul>
                <li>Process of automating the creation of a software build</li>
                <li>Build steps like Cleaning, Compiling, Packaging</li>
                <li>Reproducible builds = eliminate chance of human error</li>
              </ul>
            </aside>
          </section>

          <section>
            <img class="no-border" style="width:700px" data-src="images/logo.png" alt="Logo">
            <h5 class="subtitle">Build Automation with C# DSL and full IDE support</h5>
          </section>

				</section>


				<section>

					<section><h2>But we have ...</h2></section>

					<section><h3>Build servers</h3></section>

					<section>
						<img data-src="images/build-servers01.png" alt="Build Step Configuration" />

						<aside class="notes">
							<ul>
								<li>Bunch of custom tasks implemented from the build server</li>
								<li>Forces to rebuild from scratch when switching the server</li>
								<li>Sometimes manual re-implementation</li>
								<li>Harder to execute locally</li>
							</ul>
						</aside>
					</section>

					<section>
						<img data-src="images/build-servers02.png" alt="Build Step Configuration" />

						<aside class="notes">
							<ul>
								<li>Invoking a script instead is easy to port</li>
								<li>Much less coupling to the build server</li>
								<li>Run build from everywhere</li>
							</ul>
						</aside>
					</section>

					<section>
						<h3>Build systems</h3>

						<aside class="notes">
							<ul>
								<li>Invoked via scripts (ps1, sh, cmd)</li>
								<li>Always versioned along the repository</li>
							</ul>
						</aside>
					</section>

					<section>
						<img data-src="images/fake-cake.png" alt="GitHub Star History: FAKE & CAKE" />
					</section>

					<section>
						<h4>FAKE</h4>
						<pre><code class="fsharp" data-trim contenteditable style="font-size: 24px; line-height: 28px;max-height: 100%">
#r @"packages/FAKE/tools/FakeLib.dll"

open Fake

Target "Default" (fun _ ->
  trace "Hello World from FAKE"
)

RunTargetOrDefault "Default"
						</code></pre>

						<aside class="notes">
							<ul>
								<li>Scripting experience / preprocessor directives</li>
								<li>Requires people to learn a "bit" of F# (?)</li>
								<li>Corporate teams: requirement for new employees</li>
								<li>Open-source projects: skipped participation</li>
							</ul>
						</aside>
					</section>

					<section>
						<h4>CAKE</h4>
						<pre><code class="csharp" data-trim contenteditable style="font-size: 24px; line-height: 28px;max-height: 100%">
var target = Argument("target", "Default");

Task("Default")
  .Does(() =>
  {
    Information("Hello World from CAKE");
  });

RunTarget(target);
						</code></pre>

						<aside class="notes">
							<ul>
								<li>Scripting experience / preprocessor directives</li>
								<li>Requires extensions to be installed</li>
								<li>Requires how-to's to be read</li>
								<li>Extended support only in Omnisharp-based IDEs</li>
							</ul>
						</aside>
					</section>

				</section>













































				<section>

					<section><h2>A simple C# Project</h2></section>

					<section>
						<h4>NUKE</h4>
						<pre><code class="csharp line-numbers" data-trim style="font-size: 24px; line-height: 28px;max-height: 100%">
class Build : NukeBuild
{
  public static int Main () =&gt; Execute&lt;Build&gt;(x =&gt; x.Default);

  Target Default =&gt; _ =&gt; _
        .Executes(() =&gt;
        {
          Logger.Info("Hello World from NUKE");
        });
}
						</code></pre>

						<aside class="notes">
							<ul>
								<li>Simple class with base class NukeBuild</li>
								<li>Resides in a simple console application</li>
								<li>Main method declares default target and returns exit code</li>
								<li>Targets as expression-bodied properties returning a delegate type</li>
							</ul>
						</aside>
					</section>

					<section>
						<img data-src="images/completion.png" alt="Auto-completion" />
						<aside class="notes">
							<ul>
								<li>Syntax-highlighting and auto-completion (OOTB)</li>
								<li>Code Formatting</li>
								<li>Also make use of xml documentation</li>
							</ul>
						</aside>
					</section>
					<section>
						<img data-src="images/navigation.png" alt="Navigation" />
						<aside class="notes">
							<ul>
								<li>Properties not only allow superior referencing</li>
								<li>They are symbols -&gt; we can actually navigate to them</li>
							</ul>
						</aside>
					</section>
					<section>
						<img data-src="images/debugging.png" alt="Debugging" />
						<aside class="notes">
							<ul>
								<li>Everyone can debug a console application</li>
							</ul>
						</aside>
					</section>

					<section id="environments">
						<img class="no-border" data-src="images/visualstudio.png" alt="VisualStudio" />
						<img class="no-border" data-src="images/rider.png" alt="JetBrains Rider" />
						<img class="no-border" data-src="images/omnisharp.png" alt="OmniSharp" />
					</section>

					<section>
						<ul>
							<li class="fragment">No scripting experience</li>
							<li class="fragment">No preprocessing</li>
							<li class="fragment">No extensions</li>
							<li class="fragment">No how-to's</li>
						</ul>

						<aside class="notes">
							<ul>
								<li>We spent less time building for non-features</li>
							</ul>
						</aside>
					</section>

					<section>
						<h3><span style="border-bottom:6px solid #FFBB00">Everyone</span> can manage the build.</h3>

						<aside class="notes">
							<ul>
								<li>From a purely technically view</li>
								<li>No special knowledge required</li>
								<li>Allows a cultural change</li>
							</ul>
						</aside>
					</section>

				</section>









































				<section>
					<section><h2>Real world example</h2></section>

					<section>
						<h3>Fictional project</h3>
						<img class="no-border" data-src="images/build-chain.svg" alt="Common Build Chain" />
					</section>


          <section>
          	<h4>Clean</h4>
            <pre><code class="csharp" data-trim contenteditable style="font-size: 22px; line-height: 26px;max-height: 100%">
// ...

class Build : NukeBuild
{
  // SourceDirectory => ./src xor ./source

  IEnumerable&lt;string&gt; BuildArtifactDirectories =>
        GlobDirectories(SourceDirectory, "*/bin", "*/obj");

  Target Clean => _ => _
        .Executes(() =>
        {
          DeleteDirectories(BuildArtifactDirectories);
          EnsureCleanDirectory(OutputDirectory);
        });
}
            </code></pre>
          </section>
          <section>
          	<h4>Restore</h4>
            <pre><code class="csharp" data-trim contenteditable style="font-size: 22px; line-height: 26px;max-height: 100%">
// ...

class Build : NukeBuild
{
  // Configuration => IsServerBuild ? "Release" : "Debug";

  Target Restore => _ => _
        .DependsOn(Clean)
        .Executes(() =>
        {
          MSBuild(SolutionFile, s => s
              .SetConfiguration(Configuration)
              .SetTargets("Restore"));
        });
}
            </code></pre>
          </section>
          <section>
          	<h4>Build</h4>
            <pre><code class="csharp" data-trim contenteditable style="font-size: 22px; line-height: 26px;max-height: 100%">
// ...

class Build : NukeBuild
{
  [GitVersion] readonly GitVersion GitVersion;

  Target Compile => _ => _
        .DependsOn(Restore)
        .Executes(() =>
        {
          MSBuild(SolutionFile, s => s
              .SetConfiguration(Configuration)
              .SetTargets("Build")
              .SetAssemblyVersion(GitVersion.AssemblySemVer)
              .SetFileVersion(GitVersion.FullSemVer));
        });
}
            </code></pre>
          </section>
          <section>
          	<h4>Pack</h4>
            <pre><code class="csharp" data-trim contenteditable style="font-size: 22px; line-height: 26px;max-height: 100%">
// ...

class Build : NukeBuild
{
  string PackageDirectory => OutputDirectory / "packages";

  Target Pack => _ => _
        .DependsOn(Build)
        .Executes(() =>
        {
          MSBuild(SolutionFile, s => s
              .SetConfiguration(Configuration)
              .SetTargets("Pack")
              .EnableIncludeSymbols()
              .SetPackageOutputPath(PackageDirectory)
              .SetPackageVersion(GitVersion.NuGetVersionV2));
        });
}
            </code></pre>
          </section>
          <section>
          	<h4>Push</h4>
            <pre><code class="csharp" data-trim contenteditable style="font-size: 22px; line-height: 26px;max-height: 100%">
// ...

class Build : NukeBuild
{
  [Parameter] string ApiKey;
  [Parameter] string SourceUrl;

  Target Push => _ => _
        .Requires(() => ApiKey, () => SourceUrl)
        .DependsOn(Pack)
        .Executes(() =>
        {
          GlobFiles(PackageDirectory, "*.nupkg")
              .ForEach(x => NuGetPush(s => s
                  .SetTargetPath(x)
                  .SetSource(SourceUrl)
                  .SetApiKey(ApiKey)));
        });
}
            </code></pre>
          </section>
				</section>



































				<section>
          <section><img data-src="images/build.jpg" alt="Writing a Build System" /></section>
					<section>
            <img data-src="images/cake.png" alt="Cake on GitHub" />
            <img data-src="images/fake.png" alt="Fake on GitHub" />
          </section>
				</section>

				<section>

					<section data-background="images/generation02.gif">
						<h2>Code-Generation</h2>

						<aside class="notes">
							<ul>
								<li></li>
							</ul>
						</aside>
					</section>


					<section>
						<h4>MSBuild CLI Reference</h4>
						<img data-src="images/msbuild_reference01.png" style="height:80%;width:80%" />
					</section>
					<section>
						<h4>MSBuild CLI Reference</h4>
						<img data-src="images/msbuild_reference02.png" style="height:80%;width:80%" />
					</section>

					<section>
						<h4>Extracted Metadata</h4>
						<pre><code class="json" data-trim contenteditable style="font-size: 17px; line-height: 20px;max-height: 100%">
{
  "name": "NoLogo",
  "type": "bool",
  "format": "/nologo",
  "help": "Don't display the startup banner or the copyright message."
},
{
  "name": "Targets",
  "type": "List&lt;string&gt;",
  "format": "/target:{value}",
  "separator": ";",
  "help": "&lt;p&gt;Build the specified targets in the project. Specify each target ..."
},
{
  "name": "Properties",
  "type": "Dictionary&lt;string, object&gt;",
  "format": "/property:{value}",
  "itemFormat": "{key}={value}",
  "disallowedCharacter": ";",
  "help": "&lt;p&gt;Set or override the specified project-level properties, where name ...",
  "delegates": [ ... ]
}
						</code></pre>
					</section>

          <section>
            <h4>Strings &amp; Numbers</h4>
            <pre><code class="csharp" data-trim contenteditable style="font-size: 22px; line-height: 26px;max-height: 100%">
MSBuild(x => x
  // string
  .SetConfiguration("release")
  .ResetConfiguration()
  // integer
  .SetMaxCpuCount(5)
  .ResetMaxCpuCount()
  // enumeration
  .SetVerbosity(MSBuildVerbosity.Diagnostic)
  .ResetVerbosity());
            </code></pre>
          </section>

          <section>
            <h4>Booleans</h4>
            <pre><code class="csharp" data-trim contenteditable style="font-size: 22px; line-height: 26px;max-height: 100%">
MSBuild(x => x
  // common
  .SetNodeReuse(true)
  .ResetNodeReuse()
  // additional
  .EnableNodeReuse()
  .DisableNodeReuse()
  .ToggleNodeReuse());
            </code></pre>
          </section>

          <section>
            <h4>Lists</h4>
            <pre><code class="csharp" data-trim contenteditable style="font-size: 22px; line-height: 26px;max-height: 100%">
MSBuild(x => x
  // common
  .SetTargets("Clean", "Build")
  // additional
  .AddTargets("Pack")
  .RemoveTargets("Build")
  .ClearTargets());
            </code></pre>
          </section>

          <section>
            <h4>Lookups</h4>
            <pre><code class="csharp" data-trim contenteditable style="font-size: 22px; line-height: 26px;max-height: 100%">
Xunit(x => x
  // common
  .SetTraits("Category", "Unit", "Web")
  // additional
  .AddTraits("Performance", "Long-running")
  .RemoveTraits("Category", "Web")
  .ClearTraits());
            </code></pre>
          </section>

          <section>
            <h4>Dictionary</h4>
            <pre><code class="csharp" data-trim contenteditable style="font-size: 22px; line-height: 26px;max-height: 100%">
MSBuild(x => x
  // common
  .SetProperties(dictionary)
  // additional
  .AddProperty("RunCodeAnalysis", true)
  .SetProperty("RunCodeAnalysis", false)
  .RemoveProperty("OutDir")
  .ClearProperty());
            </code></pre>
          </section>

          <section>
            <h4>Delegates</h4>
            <pre><code class="csharp" data-trim contenteditable style="font-size: 22px; line-height: 26px;max-height: 100%">
MSBuild(x => x
  .SetPackageId("GhostBusters")
  .SetFileVersion("1.3.3.7")
  .SetNoWarns(1000, 1002) // /p:NoWarns=\"1000;1002\"
  .DisableWarningsAsErrors()
  .EnableRunCodeAnalysis());
            </code></pre>
          </section>

          <section>
            <ul>
              <li class="fragment">Tool path resolution</li>
              <li class="fragment">Built-in and custom assertions</li>
              <li class="fragment">Custom formatting</li>
              <li class="fragment">Custom invocation</li>
              <li class="fragment">Return value transformation</li>
            </ul>
          </section>

					<section>
						<ul>
							<li class="fragment">Fast, reliable, efficient</li>
							<li class="fragment">Friendly for new features</li>
							<li class="fragment">Changes are detected automatically</li>
						</ul>

						<aside class="notes">
							<ul>
								<li>Often takes just a few minutes</li>
								<li>Reduces bugs, quoting errors, and typos</li>
								<li>Doesn't require tests</li>
							</ul>
						</aside>
					</section>

				</section>




































        <section>
          <section><h2>Demo</h2></section>
          <section><h3>CLI Experience</h3></section>
          <section><h3>Default Settings</h3></section>
          <section><h3>Path Construction</h3></section>
          <section><h3>Environment Adaption</h3></section>
          <section><h3>Documentation</h3></section>
        </section>


















				<section>

					<section><h2>Long-term Goals</h2></section>

					<section>
						<table class="table center-table">
				      <tr>
				      	<td class="fragment"><span class="icon icon-code"></span><p>Consistency</p></td>
				      	<td class="fragment"><span class="icon icon-lab"></span><p>Research</p></td>
                <td class="fragment"><span class="icon icon-users4"></span><p>Collaboration</p></td>
  			      </tr>
				    </table>

						<aside class="notes">
							<ul>
								<li>Consistent API + make addins only for technical reasons</li>
								<li>Share metadata with other languages/ecosystems and tools</li>
								<li>Research: parse from debug sessions</li>
								<li>Research: write analyzers/inspections</li>
							</ul>
						</aside>
					</section>

				</section>

				<section>

					<section data-background="images/bryan.gif" data-autoslide="3000"></section>
					<section data-background="images/bryan.png">
						<ul class="references">
							<li><span class="icon icon-sphere2"></span>nuke.build</li>
							<li><span class="icon icon-github"></span>github.com/nuke-build/nuke</li>
							<li><span class="icon icon-twitter"></span>@nukebuildnet</li>
							<li><span class="icon icon-bubble"></span>gitter.im/nuke-build/nuke</li>
							<li><span class="icon icon-presentation"></span>present.nuke.build</li>
						</ul>
					</section>

				</section>

			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				slideNumber: true,
				transition: 'fade',
				showNotes: true,
				history: true,
				controls: false,
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'socket.io/socket.io.js', async: true },
					{ src: 'plugin/notes-server/client.js', async: true },
					{ src: 'plugin/line-numbers/line-numbers.js', async: false }
				]
			});
		</script>
	</body>
</html>
